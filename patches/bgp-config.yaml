cluster:
  inlineManifests:
    - name: cilium-bgp-config
      contents: |
        apiVersion: cilium.io/v2
        kind: CiliumBGPClusterConfig
        metadata:
          name: cilium-bgp
        spec:
          bgpInstances:
            - name: cluster
              localASN: 64513
              peers:
                - name: opnsense-v4
                  peerASN: 64512
                  peerAddress: 10.50.1.1
                  peerConfigRef:
                    name: cilium-peer-v4
        ---
        apiVersion: cilium.io/v2
        kind: CiliumBGPPeerConfig
        metadata:
          name: cilium-peer-v4
        spec:
          families:
            - afi: ipv4
              safi: unicast
              advertisements:
                matchLabels:
                  advertise: bgp
          gracefulRestart:
            enabled: true
            restartTimeSeconds: 15
        ---
        apiVersion: cilium.io/v2
        kind: CiliumBGPAdvertisement
        metadata:
          name: bgp-advertisements
          labels:
            advertise: bgp
        spec:
          advertisements:
            - advertisementType: "Service"
              service:
                addresses:
                  - ExternalIP
                  - LoadBalancerIP
              selector:
                matchExpressions:
                  - { key: somekey, operator: NotIn, values: ["never-used-value"] }
        ---
        apiVersion: cilium.io/v2
        kind: CiliumLoadBalancerIPPool
        metadata:
          name: service-pool-bgp
        spec:
          allowFirstLastIPs: "No"
          blocks:
            - cidr: 10.50.2.0/24
